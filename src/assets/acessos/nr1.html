<!--Formulário de prova do Genilson-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NR 1 - Integração</title>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
</head>

<body>
    <img src="https://cestsegtrabalho.com.br/wp-content/uploads/2022/09/logo-e1663851774609.png" width="40%">
    <h1>NR 1 - Integração</h1>
    <h3><b>Preencha os dados abaixo e faça a prova <br>
        Nota mínima 80% <br>
        Após aprovação já está registrado</h3><br>
<script>
                function validarSenha() {
                    var senha = document.getElementById("senha").value;
                    if (senha !== 'Cest2p') {
                        alert("Senha incorreta! Tente novamente.");
                        return false; // Impede o envio do formulário
                    }
                    return true; // Permite o envio se a senha estiver correta
                }
                </script>
               <form id="submit" action="#" name="form-contact" onsubmit="return validarSenha()">
               <input type="text" id="name" placeholder="Nome completo:" required><br>
               <input type="text" id="cpf" placeholder="CPF:" required><br>
               <input type="text" id="nome_empresa" placeholder="Nome da empresa: (Opcional)"><br>
               <input type="text" id="whatsapp" placeholder="Whatsapp:" required><br>
               <input type="email" id="email" placeholder="Email:" required><br>
               <input type="text" id="senha" placeholder="Digite a senha" required>
        <br> Data <br>
<input type="date" id="data_Genilson"><br><br>
        <input type="submit" value="Enviar" id="submit">
    </form>
    <script src="./index.js"></script>
</body>
</html>

<script>
//LocalStorage
function setLocalStorage() {
    localStorage.setItem("name", name.value)
    localStorage.setItem("cpf", cpf.value)
}
//Cria variáveis que recebem os valores dos inputs
const name = document.getElementById('name');
const whatsapp = document.getElementById('whatsapp');
const email = document.getElementById('email');
const nome_empresa = document.getElementById('nome_empresa');
const cpf = document.getElementById('cpf');
const datadehoje = document.getElementById('data');
const submit = document.getElementById('submit');
const dataGenilson = document.getElementById('data_Genilson');

//Pega dia e hora e coloca na variável dataAtual
const data = new Date()
const dia = String(data.getDate()).padStart(2, '0') //trasforma 1 em 01
const mes = String(data.getMonth() + 1).padStart(2, '0') //trasforma 1 em 01
const ano = data.getFullYear() // 2023
const hora = String(data.getHours()).padStart(2, '0') //trasforma 1 em 01
const minuto = String(data.getMinutes()).padStart(2, '0') //trasforma 1 em 01
const segundo = String(data.getSeconds()).padStart(2, '0') //trasforma 1 em 01
const dataAtual = `Aluno concluiu a prova em ${dia}/${mes}/${ano} às ${hora}:${minuto}:${segundo}`

//corpo do email com tudo que será enviado para o Email
submit.addEventListener('submit',(e)=>{
    e.preventDefault();
    if (!validarSenha()) {
            return; // Se a senha estiver errada, interrompe tudo aqui
            }
    let ebody = `
    <div><img src="https://cestsegtrabalho.com.br/wp-content/uploads/2022/09/logo-e1663851774609.png" width="100%"></div>
    <br><br>
    <h3>O aluno ${name.value} concluiu a prova de NR 1 - Integração conforme treinamento com nota 10</h3>
    <br><br>
    <h3 style="margin: 0%;">Nome do aluno:</h3>${name.value}
    <br><br>
    <h3>Nome do curso: NR 1 - Integração</h3>
    <h3 style="margin: 0%;">Whatsapp do aluno:</h3>${whatsapp.value}
    <br><br>
    <h3 style="margin: 0%;">Email do aluno: </h3>${email.value}
    <br><br>
    <h3 style="margin: 0%;">CPF do aluno: </h3>${cpf.value}
    <br><br>
    <h3 style="margin: 0%;">Nome da Empresa (Opcional): </h3>${nome_empresa.value}
    <br><br>
    
    <br><br>
 <h3 style="font-weight: bold;">Data: </h3>${dataGenilson.value}
    `;

    Email.send({
        SecureToken : "58bc9bda-20b7-472d-9522-6edc923b7f69", //add your token here
        To : 'cestsegtrabalho@gmail.com', //pode colocar email.value e será enviado pro email ou colocar o email digitado mas ficará fixo
        From : "cestsegtrabalho@gmail.com", //email que enviará a mensagem para o usuário
        Subject : "O aluno concluiu a prova",
        Body : ebody
    }).then(
        window.open('/src/provas/nr1-integracao.html', '_self'), setLocalStorage() 
    );
});
</script>

<!--COMEÇO DO CSS-->
<style type="text/css">
    input {
        align-content: center;
        align-items: center;
        width: 30%;
    }

    body{
        align-items: center;
        text-align: center;
    }

    @media screen and (max-width: 700px){
        input {
            width: 90%;
        }
    }
</style>